#!/usr/bin/env bash

# run imagemagik to downsize images in named directory

# if convert is not installed, exit with error message
if ! command -v convert &> /dev/null; then
  echo "Imagemagick's 'convert' is not installed or not in the PATH." >&2
  exit 1
fi

file="$1"

if [ -f "$file" ]; then
  directory=$(dirname "$file")
  basename=$(basename "$file")
  newfile="${directory}/smaller-${basename}"
  magick "$file" -resize 1980x1080\> $newfile
  /Applications/ImageOptim.app/Contents/MacOS/ImageOptim  "$newfile"
  echo "downrezzed $file to 1980x1080"
else
  echo "File $file does not exist" >&2
  exit 1
fi